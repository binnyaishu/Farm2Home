<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard | Farm2Home Management</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ðŸŒ¿ General Reset & Typography (Reusing index.html styles for consistency) */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", Arial, sans-serif;
      }

      /* ðŸŽ¨ GREEN & GOLD PALETTE */
      :root {
        --color-primary-green: #388e3c; /* Deep Green */
        --color-secondary-gold: #ffc107; /* Amber Gold */
        --color-dark-text: #212121;
        --color-light-bg: #f9f9f9;
        --color-red: #f44336;
        --color-blue: #1976d2;
        --color-dark-gold: #e6a700; /* Darker Gold for Hover */
      }

      body {
        background-color: var(--color-light-bg);
        line-height: 1.6;
        color: var(--color-dark-text);
        padding-top: 80px; /* Space for fixed navbar */
      }

      /* --- NAVBAR STYLES (Copied from index.html) --- */
      .main-header {
        width: 100%;
        background: linear-gradient(90deg, var(--color-primary-green), #4caf50);
        padding: 15px 0;
        position: fixed;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 90%;
        max-width: 1200px;
        margin: auto;
      }

      .navbar h1 {
        font-size: 1.8em;
        font-weight: 800;
        color: #ffffff;
      }

      .navbar h1 .fa-seedling {
        color: var(--color-secondary-gold);
      }

      .navbar ul {
        list-style: none;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
      }

      .navbar li {
        margin-left: 15px;
      }

      .navbar a {
        text-decoration: none;
        color: #ffffff;
        font-weight: 600;
        padding: 8px 12px;
        border-radius: 6px;
        transition: background 0.3s ease, transform 0.2s ease;
        display: inline-block;
      }

      .navbar a:hover,
      .navbar .active-link {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      /* --- NAV BUTTON VARIANTS (Copied from index.html) --- */
      .nav-farmer-btn,
      .nav-admin-btn,
      .nav-login-btn {
        background: #ffffff !important;
        color: var(--color-primary-green) !important;
        font-weight: 700 !important;
        border: 2px solid var(--color-primary-green);
      }

      .nav-admin-btn {
        /* Highlighting Admin button on its own page */
        background: var(--color-secondary-gold) !important;
        color: var(--color-dark-text) !important;
        border: 2px solid var(--color-secondary-gold);
      }

      .nav-farmer-btn:hover,
      .nav-admin-btn:hover,
      .nav-login-btn:hover {
        background: var(--color-light-bg) !important;
        color: var(--color-primary-green) !important;
      }

      .nav-logout-btn {
        background: var(--color-red) !important;
        color: white !important;
        font-weight: 700 !important;
        border: none;
      }

      .nav-logout-btn:hover {
        background: #e53935 !important;
      }

      /* --- ALERT (Copied from index.html) --- */
      .custom-alert {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 20px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        z-index: 9999;
        text-align: center;
        font-weight: 600;
        border: 3px solid var(--color-primary-green);
        max-width: 300px;
        animation: fadeinout 3s forwards;
      }

      @keyframes fadeinout {
        0% {
          opacity: 0;
        }
        20% {
          opacity: 1;
        }
        80% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      /* --- DASHBOARD STYLES --- */
      .dashboard-container {
        width: 90%;
        max-width: 1200px;
        margin: 40px auto;
        padding: 20px;
      }

      .dashboard-container h2 {
        font-size: 2.8em;
        font-weight: 800;
        color: var(--color-dark-text);
        margin-bottom: 5px;
        border-bottom: 4px solid var(--color-secondary-gold);
        display: inline-block;
      }

      .welcome-message {
        font-size: 1.1em;
        color: #616161;
        margin-bottom: 30px;
      }

      .stats-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 40px;
      }

      .stat-card {
        flex: 1 1 220px;
        background: white;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        transition: transform 0.2s ease;
        border-left: 5px solid var(--color-primary-green);
      }

      .stat-card:hover {
        transform: translateY(-3px);
      }

      .stat-card i {
        font-size: 2em;
        color: var(--color-secondary-gold);
        margin-bottom: 10px;
      }

      .stat-card h4 {
        font-size: 1.2em;
        color: #616161;
        font-weight: 600;
      }

      .stat-number {
        font-size: 2.5em;
        font-weight: 800;
        color: var(--color-primary-green);
      }

      /* --- ACTION PANELS --- */
      .action-panels {
        display: grid;
        grid-template-columns: 1fr;
        gap: 30px;
      }

      @media (min-width: 900px) {
        .action-panels {
          grid-template-columns: 2fr 1fr;
        }
      }

      .panel {
        background: white;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .panel h3 {
        font-size: 1.8em;
        color: var(--color-dark-text);
        margin-bottom: 20px;
        font-weight: 700;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
      }

      .user-list {
        list-style: none;
        padding: 0;
      }

      .user-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0; /* Increased padding */
        border-bottom: 1px solid #e0e0e0; /* Slightly darker divider */
        transition: background-color 0.1s ease;
      }

      .user-item:hover {
        background-color: var(--color-light-bg);
      }

      .user-item:last-child {
        border-bottom: none;
      }

      .user-details strong {
        color: var(--color-primary-green);
        font-size: 1.1em;
      }

      .user-details small {
        display: block;
        color: #757575;
      }

      /* Admin Action Buttons */
      .user-item button {
        border: none;
        padding: 8px 15px;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.2s ease, transform 0.1s ease;
        font-size: 0.9em;
        font-weight: 600;
        margin-left: 10px; /* Spacing between buttons */
      }

      .user-item button:active {
        transform: translateY(1px);
      }

      .user-item button.approve-btn {
        background: var(--color-primary-green);
        color: white;
      }

      .user-item button.approve-btn:hover {
        background: #4caf50;
      }

      .user-item button.suspend-btn {
        /* Suspend is the "Reject" button in the farmer list */
        background: var(--color-red);
        color: white;
      }

      .user-item button.suspend-btn:hover {
        background: #e53935;
      }

      /* NEW STYLE: Approved Badge */
      .approved-badge {
        background: var(--color-primary-green);
        color: white;
        padding: 8px 15px;
        border-radius: 6px;
        font-weight: 700;
        font-size: 0.9em;
        display: flex;
        align-items: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .approved-badge i {
        margin-right: 8px;
        color: white;
        font-size: 1.1em;
      }

      /* NEW STYLE: Rejected Badge */
      .rejected-badge {
        background: var(--color-red);
        color: white;
        padding: 8px 15px;
        border-radius: 6px;
        font-weight: 700;
        font-size: 0.9em;
        display: flex;
        align-items: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .rejected-badge i {
        margin-right: 8px;
        color: white;
        font-size: 1.1em;
      }

      /* --- FOOTER (Copied from index.html) --- */
      footer {
        background: var(--color-dark-text);
        color: white;
        text-align: center;
        padding: 25px 0;
        font-size: 0.95em;
        font-weight: 300;
        margin-top: 40px;
      }

      /* Mobile responsiveness for action panel buttons */
      @media (max-width: 600px) {
        .user-item {
          flex-direction: column;
          align-items: flex-start;
        }
        .user-item > div:nth-child(2) {
          margin-top: 10px;
        }
        .user-item button {
          margin-left: 0;
          margin-right: 10px;
          margin-top: 5px;
        }
      }
    </style>
  </head>

  <body>
    <!-- ----------------- NAVBAR ----------------- -->
    <header class="main-header">
      <nav class="navbar">
        <h1>Farm2Home <i class="fas fa-seedling"></i></h1>
        <ul id="mainNavList">
          <li><a href="index.html">Home</a></li>
          <li><a href="products.html">Products</a></li>

          <!-- Farmer link is hidden by default, shown by JS if role is farmer -->
          <li id="farmerNavLink" style="display: none">
            <a href="listProduce.html" class="nav-farmer-btn">
              <i class="fas fa-box"></i> List Produce
            </a>
          </li>

          <!-- Admin link is visible for admin, active state on this page -->
          <li id="adminNavLink">
            <a href="admin_dashboard.html" class="nav-admin-btn">
              <i class="fas fa-user-shield"></i> Admin Dashboard
            </a>
          </li>

          <!-- Login/Logout dynamically updated by JS -->
          <li id="loginLogoutLi">
            <a href="#" class="nav-login-btn" id="loginLogoutBtn">
              <i class="fas fa-user"></i> Login
            </a>
          </li>
        </ul>
      </nav>
    </header>

    <!-- ----------------- MAIN DASHBOARD CONTENT ----------------- -->
    <main class="dashboard-container">
      <h2>Platform Overview</h2>
      <p class="welcome-message" id="adminWelcome">
        Welcome back, Admin. This is your command center for the Farm2Home
        platform.
      </p>

      <!-- Stats Grid - Updated with Rupees and more realistic data for an India-centric platform -->
      <section class="stats-grid">
        <div class="stat-card">
          <h4>Total Users</h4>
          <div class="stat-number">2,145</div>
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-card">
          <h4>Pending Farmer Approvals</h4>
          <div class="stat-number">7</div>
          <i class="fas fa-user-check"></i>
        </div>
        <div class="stat-card">
          <h4>Total Revenue (MTD)</h4>
          <!-- Currency changed to Rupees -->
          <div class="stat-number">â‚¹1,25,890</div>
          <i class="fas fa-rupee-sign"></i>
        </div>
        <div class="stat-card">
          <h4>Active Listings</h4>
          <div class="stat-number">458</div>
          <i class="fas fa-leaf"></i>
        </div>
      </section>

      <!-- Action Panels - Updated with Indian Names and dynamic buttons -->
      <section class="action-panels">
        <!-- Panel 1: Pending Farmer Approvals -->
        <div class="panel">
          <h3><i class="fas fa-user-plus"></i> New Farmer Applications</h3>
          <ul class="user-list" id="farmerApplicationList">
            <!-- 1. Kisan Krishi Kendra -->
            <li class="user-item" id="farmer-kisan">
              <div class="user-details">
                <strong>Kisan Krishi Kendra</strong><br />
                <small>Location: Pune | Date: 2024-10-25</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Kisan Krishi Kendra', 'farmer-kisan')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Kisan Krishi Kendra', 'farmer-kisan')"
                >
                  Reject
                </button>
              </div>
            </li>
            <!-- 2. Suresh Farms -->
            <li class="user-item" id="farmer-suresh">
              <div class="user-details">
                <strong>Suresh Farms</strong><br />
                <small>Location: Nashik | Date: 2024-10-26</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Suresh Farms', 'farmer-suresh')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Suresh Farms', 'farmer-suresh')"
                >
                  Reject
                </button>
              </div>
            </li>
            <!-- 3. Priya Organic Produce -->
            <li class="user-item" id="farmer-priya">
              <div class="user-details">
                <strong>Priya Organic Produce</strong><br />
                <small>Location: Bengaluru | Date: 2024-10-27</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Priya Organic Produce', 'farmer-priya')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Priya Organic Produce', 'farmer-priya')"
                >
                  Reject
                </button>
              </div>
            </li>
            <!-- 4. Sanjay Agro Products (NEW) -->
            <li class="user-item" id="farmer-sanjay">
              <div class="user-details">
                <strong>Sanjay Agro Products</strong><br />
                <small>Location: Indore | Date: 2024-10-27</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Sanjay Agro Products', 'farmer-sanjay')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Sanjay Agro Products', 'farmer-sanjay')"
                >
                  Reject
                </button>
              </div>
            </li>
            <!-- 5. Rani's Dairy & Crops (NEW) -->
            <li class="user-item" id="farmer-rani">
              <div class="user-details">
                <strong>Rani's Dairy & Crops</strong><br />
                <small>Location: Lucknow | Date: 2024-10-28</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Rani\'s Dairy & Crops', 'farmer-rani')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Rani\'s Dairy & Crops', 'farmer-rani')"
                >
                  Reject
                </button>
              </div>
            </li>
            <!-- 6. Raj Farm Exports (NEW) -->
            <li class="user-item" id="farmer-raj">
              <div class="user-details">
                <strong>Raj Farm Exports</strong><br />
                <small>Location: Ahmedabad | Date: 2024-10-28</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Raj Farm Exports', 'farmer-raj')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Raj Farm Exports', 'farmer-raj')"
                >
                  Reject
                </button>
              </div>
            </li>
            <!-- 7. Anita Agri Ventures (NEW) -->
            <li class="user-item" id="farmer-anita">
              <div class="user-details">
                <strong>Anita Agri Ventures</strong><br />
                <small>Location: Hyderabad | Date: 2024-10-28</small>
              </div>
              <div class="action-buttons-container">
                <button
                  class="approve-btn"
                  onclick="handleAction('Approved', 'Anita Agri Ventures', 'farmer-anita')"
                >
                  Approve
                </button>
                <button
                  class="suspend-btn"
                  onclick="handleAction('Rejected', 'Anita Agri Ventures', 'farmer-anita')"
                >
                  Reject
                </button>
              </div>
            </li>
          </ul>
          <p style="text-align: center; margin-top: 15px">
            <a
              href="#"
              style="
                color: var(--color-blue);
                text-decoration: none;
                font-weight: 600;
              "
              >View All Pending Applications &rarr;</a
            >
          </p>
        </div>

        <!-- Panel 2: System Quick Actions -->
        <div class="panel">
          <h3><i class="fas fa-tools"></i> System & Finance Controls</h3>
          <ul class="user-list">
            <li class="user-item">
              <div class="user-details">System Maintenance (3 AM IST)</div>
              <!-- Removed view button from system actions too for consistency -->
              <button
                class="suspend-btn"
                onclick="handleAction('Scheduled', 'System Maintenance')"
              >
                Schedule Now
              </button>
            </li>
            <li class="user-item">
              <div class="user-details">Generate Sales Report (Monthly)</div>
              <button
                class="approve-btn"
                onclick="handleAction('Generated', 'Sales Report')"
              >
                Generate
              </button>
            </li>
            <li class="user-item">
              <div class="user-details">Clear Platform Cache</div>
              <button
                class="suspend-btn"
                onclick="handleAction('Cleared', 'Cache')"
              >
                Clear
              </button>
            </li>
            <li class="user-item">
              <div class="user-details">Broadcast Email to Farmers</div>
              <button
                class="approve-btn"
                onclick="handleAction('Opened', 'Email Composer')"
              >
                Compose
              </button>
            </li>
          </ul>
        </div>
      </section>
    </main>

    <!-- ----------------- FOOTER ----------------- -->
    <footer>
      <p>&copy; 2024 Farm2Home Admin. Platform Managed by You.</p>
    </footer>

    <!-- ----------------- SCRIPT ----------------- -->
    <script>
      let loggedInUser = null;

      // Custom Alert function (Copied from index.html)
      function customAlert(message) {
        const alertBox = document.createElement("div");
        alertBox.className = "custom-alert";
        alertBox.innerHTML = message;
        document.body.appendChild(alertBox);
        setTimeout(() => {
          alertBox.remove();
        }, 3000);
      }

      // Action Handler for buttons - Updated to handle the 'Approved' state change and 'Rejected'
      function handleAction(action, item, itemId) {
        let message;

        // Find the elements needed for UI update
        const listItem = document.getElementById(itemId);
        // Assuming the action buttons are in the second child div of the list item
        const actionContainer = listItem
          ? listItem.querySelector(".action-buttons-container")
          : null;

        if (action === "Approved") {
          if (actionContainer) {
            // Replace buttons with a static 'Approved' badge
            actionContainer.innerHTML = `
                    <span class="approved-badge">
                        <i class="fas fa-check-circle"></i> Approved
                    </span>
                `;
            // Visually mark the list item as processed (lighter green background)
            listItem.style.backgroundColor = "#e8f5e9";
            listItem.style.borderLeftColor = "green";
          }

          // Set success message
          message = `<i class="fas fa-check-circle" style="color: var(--color-primary-green);"></i> <strong>Success!</strong> ${item} is now an authorized farmer.`;
        } else if (action === "Rejected") {
          if (actionContainer) {
            // Replace buttons with a static 'Rejected' badge
            actionContainer.innerHTML = `
                    <span class="rejected-badge">
                        <i class="fas fa-times-circle"></i> Rejected
                    </span>
                `;
            // Visually mark the list item as processed (lighter red background)
            listItem.style.backgroundColor = "#ffebee";
            listItem.style.borderLeftColor = "var(--color-red)";
          }

          // Set rejection message
          message = `<i class="fas fa-times-circle" style="color: var(--color-red);"></i> <strong>Action Complete.</strong> ${item}'s application has been rejected.`;
        } else if (item === "Sales Report") {
          // Specific feedback with Rupee currency
          message = `<i class="fas fa-chart-line" style="color: var(--color-blue);"></i> Sales Report Generated! Total Revenue: <strong>â‚¹1,25,890</strong>.`;
        } else {
          message = `<i class="fas fa-cogs" style="color: var(--color-dark-gold);"></i> Action: ${item} has been ${action}. (Simulated)`;
        }

        customAlert(message);
      }

      // Universal Logout Handler (Copied from index.html)
      function handleLogout() {
        localStorage.removeItem("loggedInUser");
        loggedInUser = null;
        customAlert("You have been successfully logged out!");
        // Redirect to a neutral page after logout
        window.location.href = "index.html";
      }

      // Navigation & Persistence Handler (Adapted from index.html)
      function updateNavAndCheckRole() {
        const storedUser = localStorage.getItem("loggedInUser");
        if (storedUser) {
          loggedInUser = JSON.parse(storedUser);
        } else {
          loggedInUser = null;
        }

        const loginLogoutBtn = document.getElementById("loginLogoutBtn");
        const farmerNavLink = document.getElementById("farmerNavLink");
        const adminNavLink = document.getElementById("adminNavLink");
        const adminWelcome = document.getElementById("adminWelcome");

        if (loggedInUser && loggedInUser.role === "admin") {
          // Logged In Admin State
          loginLogoutBtn.innerHTML = `<i class="fas fa-sign-out-alt"></i> Logout `;
          loginLogoutBtn.classList.remove("nav-login-btn");
          loginLogoutBtn.classList.add("nav-logout-btn");
          loginLogoutBtn.onclick = handleLogout;

          adminWelcome.innerHTML = `Welcome back, <strong>${loggedInUser.username}</strong>. This is your command center for the Farm2Home platform.`;

          // Ensure only Admin link is shown and active
          farmerNavLink.style.display = "none";
          adminNavLink.style.display = "block";
        } else {
          // If not logged in, or if logged in but NOT an admin, redirect to home/login
          customAlert("Access Denied. Please log in as an Admin.");
          // We use a small delay to ensure the alert is seen before redirecting
          setTimeout(() => {
            window.location.href = "index.html";
          }, 100);
        }
      }

      // Initialize on page load
      document.addEventListener("DOMContentLoaded", updateNavAndCheckRole);
    </script>
  </body>
</html>
